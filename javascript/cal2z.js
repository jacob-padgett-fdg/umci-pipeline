_monthNames=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");_calDOW=new Array("S","M","T","W","T","F","S");_calBG="#009ad8";_calBS=3;_calBtnClr="#dddddd";_calBClr="darkblue";_calCC="#88ddff";_calCCLt="#aaffff";_calCCWeekend="#66bbdd";_calCCToday='#55ff55';_calCCSelected='#1155ff';_calCellFont="Tahoma";_calCFontSize="11px";_calTxtFont="Tahoma";_calTxtFntSz="11px";_calTxtClr="black";_calCWidth=20;_calCHeight=20;_calDOWBG="#dddddd";function BrowseDate(input_id){today=new Date();_cal_today_day=today.getDate();_cal_today_month=today.getMonth();_cal_today_year=today.getFullYear();arrParts=strDate=(document.getElementById(input_id).value.replace('-','/')).replace('-','/').split('/');OpenCalendar(arrParts[2],arrParts[0],arrParts[1],input_id);}function CalendarCallback(strSelectedDate,input_id){date=new Date(strSelectedDate);input_field=document.getElementById(input_id).value=(date.getMonth()+1)+"/"+date.getDate()+"/"+date.getFullYear();document.getElementById(input_id).onchange();}function OpenCalendar(Year,defMonth,defDay,input_id){if((typeof Year=="undefined")||(isNaN(Year)))Year=_cal_today_year;if((typeof defMonth=="undefined")||(isNaN(defMonth))||(defMonth==""))defMonth=_cal_today_month;else defMonth--;if((typeof defDay=="undefined")||(isNaN(defDay))||(defDay==""))defDay=_cal_today_day;inputobj=document.getElementById(input_id);inputobj._cal_year=Year;inputobj._cal_month=defMonth+1;inputobj._cal_day=defDay;FillCalendar(Year,defMonth+1,defDay,input_id);x=0;x+=inputobj.clientWidth;while(inputobj!=null){x+=inputobj.offsetLeft;x+=2;inputobj=inputobj.offsetParent;}y=0;inputobj=document.getElementById(input_id);while(inputobj!=null){y+=inputobj.offsetTop;inputobj=inputobj.offsetParent;}objPanel=document.getElementById('datepanel'+input_id);objPanel.style.display="block";document.getElementById(input_id).position="absolute";objPanel.style.left=x+"px";objPanel.style.top = y+"px";}function stdBtn(objRow,func,txt){cel=stdCell(objRow);cel.style.backgroundColor=_calBtnClr;cel.onmousedown=eval(func);cel.innerHTML=txt;return(cel);}function stdCell(objRow){objCell=objRow.insertCell(objRow.cells.length);objCell.setAttribute("width",_calCWidth+"");objCell.setAttribute("height",_calCHeight+"");objCell.style.border="1px solid black";objCell.style.cursor="pointer";objCell.style.textAlign="center";objCell.style.fontFamily=_calCellFont;objCell.style.fontSize=_calCFontSize;return(objCell);}function FillCalendar(year,month,day,input_id){daysCount=DaysInMonth(year,month);objPanel=document.getElementById('datepanel'+input_id);inputobj=document.getElementById(input_id);if(!objPanel){objPanel=document.createElement("div");objPanel.id='datepanel'+input_id;objPanel.style.position="absolute";objPanel.style.display="none";objPanel.style.border=_calBS+"px solid "+_calBClr;objPanel.style.backgroundColor=_calBG;objPanel.input_id=input_id;document.body.appendChild(objPanel);}objPanel._currentYear=year;objPanel._currentMonth=month-1;while(objPanel.childNodes.length>0)objPanel.removeChild(objPanel.childNodes[0]);currentDay=1;objTable=document.createElement("table");objTable.cellPadding='0';objTable.cellSpacing='0';objTable.border='0';objTable.input_id=input_id;objRow=objTable.insertRow(objTable.rows.length);objCell=stdBtn(objRow,'ShowToday','T');objCell.title='Today';objCell=stdBtn(objRow,'PreviousMonthClick','&lt;');objCell=stdCell(objRow);objCell.style.cursor="default";objCell.colSpan="3";objCell.style.fontWeight='bold';objCell.innerHTML=_monthNames[month-1]+" "+year;objCell=stdBtn(objRow,'NextMonthClick','&gt;');objCell=stdBtn(objRow,'HideCalendar','X');objCell.title='Close';x=0;objRow=objTable.insertRow(objTable.rows.length);objRow.style.backgroundColor=_calDOWBG;for(x=0;x<7;x++){objCell=objRow.insertCell(objRow.cells.length);objCell.style.textAlign="center";objCell.style.fontFamily=_calCellFont;objCell.style.fontSize=_calCFontSize;objCell.style.cursor="default";objCell.innerHTML=_calDOW[x];}objRow=0;foundMonthStart=0;month_text=_monthfullNames[month];f_dom=month_text+" 01, "+year;firstDay=new Date(eval('"'+f_dom+'"'));month_start_dow=firstDay.getDay();current_dow=0;while(currentDay<=daysCount){if((current_dow%7)==0){objRow=objTable.insertRow(objTable.rows.length);current_dow=0;}for(var i=1;i<=7;i++){if(current_dow==month_start_dow)foundMonthStart=1;if(foundMonthStart==0){objCell=stdCell(objRow);objCell.style.cursor="default";objCell.style.border="0px solid black";} else {if(currentDay>daysCount)break;objCell=stdCell(objRow);if((current_dow==0)||(current_dow==6))objCell.style.backgroundColor=_calCCWeekend;else objCell.style.backgroundColor=_calCC;if(currentDay==_cal_today_day)if((month-1)==_cal_today_month)if(year==_cal_today_year)objCell.style.backgroundColor=_calCCToday;if(currentDay==inputobj._cal_day)if((month)==inputobj._cal_month)if(year==inputobj._cal_year)objCell.style.backgroundColor=_calCCSelected;objCell.style.fontFamily=_calCellFont;objCell.style.fontSize=_calCFontSize;objCell.style.cursor="pointer";objCell.onmouseover=new Function("HL(this)");objCell.onmouseout=new Function("unHL(this)");objCell.onclick=new Function("CalendarCellClick(this);");objCell.innerHTML=currentDay;currentDay++;}current_dow++;}}objPanel.appendChild(objTable);}function ShowToday(){FillCalendar(_cal_today_year, _cal_today_month + 1, '', this.parentNode.parentNode.parentNode.input_id);}function CalendarCellClick(objCell){id=objCell.parentNode.parentNode.parentNode.input_id;HideCalendar(id);date=new Date();panelobject=document.getElementById('datepanel' + id);date.setFullYear(panelobject._currentYear, panelobject._currentMonth, parseInt(objCell.innerHTML));CalendarCallback(date,id);}function HideCalendar(id) {if (isNaN(id)) var id=this.parentNode.parentNode.parentNode.input_id;objPanel=document.getElementById('datepanel' + id);objPanel.style.display="none";}function PreviousMonthClick() {id=this.parentNode.parentNode.parentNode.input_id;panelobject=document.getElementById('datepanel'+id);panelobject._currentMonth--;if(panelobject._currentMonth<0){panelobject._currentMonth=11;panelobject._currentYear--;}FillCalendar(panelobject._currentYear,panelobject._currentMonth+1,1,id);}function NextMonthClick(){id=this.parentNode.parentNode.parentNode.input_id;panelobject=document.getElementById('datepanel'+id);panelobject._currentMonth++;if(panelobject._currentMonth>11){panelobject._currentMonth=0;panelobject._currentYear++;}FillCalendar(panelobject._currentYear,panelobject._currentMonth+1,1,id);}function DaysInMonth(year,month){date=new Date();result=27;date.setFullYear(year,month-1,28);while ((date.getFullYear()<=year)&&(date.getMonth()<=(month-1))){result++;if(result>31){alert("month length error!\nyear: "+year+", month: "+month);return 0;}date.setFullYear(year,month-1,date.getDate()+1);}return result;}function HL(objControl){objControl.orig_cell_color=objControl.style.backgroundColor;objControl.style.backgroundColor = _calCCLt;}function unHL(objControl){objControl.style.backgroundColor=objControl.orig_cell_color;}_monthfullNames=new Array("NA","January","February","March","April","May","June","July","August","September","October","November","December");_cal_today_day=0;_cal_today_month=0;_cal_today_year=0;
